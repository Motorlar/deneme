chrome.runtime.onMessage.addListener((e,s,t)=>{if(e.type==="ELEMENT_SELECTED")chrome.runtime.sendMessage(e);else if(e.type==="SELECTION_CANCELLED")chrome.runtime.sendMessage(e);else if(e.type==="SAVE_BULK_DATA")return a(e.data,t),!0;return!0});async function a(e,s){try{const o=await(await fetch(`${i}/rest/v1/customers?select=id&phone=eq.${e.customerData.phone}`,{headers:{apikey:r,Authorization:`Bearer ${r}`}})).json();if(o&&o.length>0){s({success:!1,duplicate:!0});return}const n=await fetch(`${i}/rest/v1/customers`,{method:"POST",headers:{apikey:r,Authorization:`Bearer ${r}`,"Content-Type":"application/json",Prefer:"return=representation"},body:JSON.stringify({site_config_id:e.configId,full_name:e.customerData.full_name||"",email:e.customerData.email||"",phone:e.customerData.phone||"",address:e.customerData.address||"",notes:e.customerData.notes||"",source_url:e.sourceUrl})});if(n.ok)s({success:!0});else{const c=await n.text();s({success:!1,error:c})}}catch(t){s({success:!1,error:t.message})}}const i="https://udxcgmsqozmsdzbbhbqg.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVkeGNnbXNxb3ptc2R6YmJoYnFnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2MzY2NDcsImV4cCI6MjA3NjIxMjY0N30.2TKqhJxAatR8Qvz68owEoptOAVXtgksfs01LT2dpsNs";chrome.action.onClicked.addListener(e=>{chrome.sidePanel.open({windowId:e.windowId})});
